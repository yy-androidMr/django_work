<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="
        width = device-width ,
  height = device-height ,
        initial-scale = 1,
        minimum-scale = 1,
        maximum-scale = 1,
        user-scalable =no,

<<<<<<< .mine
  " />
    <title>HTML5 drag image in page - cheungmine</title>
    <style rel="stylesheet" type="text/css">
        #_outerDiv {
            height: 200px;
            width: 500px;
            border: 1px solid black;
            position: relative;
            overflow: hidden;
||||||| .r93
  "
            />
  <title>HTML5 drag image in page - cheungmine</title>  
  <style rel="stylesheet" type="text/css" >  
    #_outerDiv{  
      height:200px;  
      width:500px;  
      border:1px solid black;  
      position:relative;  
      overflow:hidden;  
    }  
  </style>  
  <script type="text/javascript">  
    function getElem (id) {  
      return document.getElementById(id);  
    }  
  
    function trimPX (_px) {  
      if(_px==null || _px=="")  
        return 0;  
      return parseInt(_px.substr(0, _px.lastIndexOf("px")));  
    }  
  
    function hitInRect (hitX, hitY, rcLeft, rcTop, rcWidth, rcHeight) {  
      return (hitX>=rcLeft && hitX<rcLeft+rcWidth && hitY>=rcTop && hitY<rcTop+rcHeight);  
    }  
  
    function outerDiv () {  
      return getElem("_outerDiv");  
    }  
  
    function imageDiv () {  
      return getElem("_imageDiv");  
    }  
  
    var dragging = false;  
    var startTop = 0; // top is a Key Word in Chrome and Opera  
    var startLeft = 0;  
    var dragPosY = 0;  
    var dragPosX = 0;  
  
    window.addEventListener("load", initPage, false);  
  
    function initPage () {  
      //outerDiv().addEventListener("mousedown", // start moving image  
      //  function (event) {  
      //    startTop = trimPX(imageDiv().style.top);  
      //    startLeft = trimPX(imageDiv().style.left);  
      //    var width = trimPX(imageDiv().style.width);  
      //    var height = trimPX(imageDiv().style.height);  
  
      //    if (hitInRect(event.clientX, event.clientY, startLeft, startTop, width, height)) {  
      //      dragging = true;  
      //      dragPosX = event.clientX;  
      //      dragPosY = event.clientY;  
      //      event.preventDefault(); // disable default behavior of browser  
      //    }  
      //  },  
      //  false  
      //);  
   imageDiv().addEventListener('touchmove', function(event) {
        event.preventDefault();//阻止其他事件
        // 如果这个元素的位置内只有一个手指的话
		$("#info").innterHTML="被触摸:"+event.targetTouches.length ;
        if (event.targetTouches.length == 1) {
            var touch = event.targetTouches[0];  // 把元素放在手指所在的位置
            div.style.left = touch.pageX + 'px';
            div.style.top = touch.pageY + 'px';
=======
  "
    />
    <title>HTML5 drag image in page - cheungmine</title>

    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.css">
    <script src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.js"></script>
    <style rel="stylesheet" type="text/css">
        #_outerDiv {
            height: 200px;
            width: 500px;
            border: 1px solid black;
            position: relative;
            overflow: hidden;
>>>>>>> .r94
        }
<<<<<<< .mine
    </style>
    <script type="text/javascript">
        function getElem(id) {
            return document.getElementById(id);
        }

        function trimPX(_px) {
            if (_px == null || _px == "")
                return 0;
            return parseInt(_px.substr(0, _px.lastIndexOf("px")));
        }

        function hitInRect(hitX, hitY, rcLeft, rcTop, rcWidth, rcHeight) {
            return (hitX >= rcLeft && hitX < rcLeft + rcWidth && hitY >= rcTop && hitY < rcTop + rcHeight);
        }

        function outerDiv() {
            return getElem("_outerDiv");
        }

        function imageDiv() {
            return getElem("_imageDiv");
        }

        var dragging = false;
        var startTop = 0; // top is a Key Word in Chrome and Opera
        var startLeft = 0;
        var dragPosY = 0;
        var dragPosX = 0;

        window.addEventListener("load", initPage, false);

        function initPage() {
            outerDiv().addEventListener("mousedown", // start moving image
              function (event) {
                  startTop = trimPX(imageDiv().style.top);
                  startLeft = trimPX(imageDiv().style.left);
                  var width = trimPX(imageDiv().style.width);
                  var height = trimPX(imageDiv().style.height);

                  if (hitInRect(event.clientX, event.clientY, startLeft, startTop, width, height)) {
                      dragging = true;
                      dragPosX = event.clientX;
                      dragPosY = event.clientY;
                      event.preventDefault(); // disable default behavior of browser
                  }
              },
              false
            );
            //imageDiv().addEventListener('touchmove', function(event) {
            //     event.preventDefault();//阻止其他事件
            //     // 如果这个元素的位置内只有一个手指的话
            // 	$("#info").innterHTML="被触摸:"+event.targetTouches.length ;
            //     if (event.targetTouches.length == 1) {
            //         var touch = event.targetTouches[0];  // 把元素放在手指所在的位置
            //         div.style.left = touch.pageX + 'px';
            //         div.style.top = touch.pageY + 'px';
            //     }
            // }, false);
            outerDiv().addEventListener("mousemove", // moving image
              function (event) {
                  if (dragging) {
                      imageDiv().style.cursor = "pointer";

                      //  imageDiv().style.top = "0px";
                      var dx = parseInt(startLeft) + (event.clientX - dragPosX);
                      var dy = parseInt(startTop) + (event.clientY - dragPosY);
                      if (dx < 0) {
                          dx = 0;
                      } else if (dx > 300) {  //可拖动框宽度减去图片宽度
                          dx = 300;
                      }
                      if (dy < 0) {
                          dy = 0;
                      } else if (dy > 200) {
                          dy = 200;
                      }
                      imageDiv().style.left = dx + "px";
                      //	 imageDiv().style.top = parseInt(startTop)+(event.clientY - dragPosY) + "px";
                      imageDiv().style.top = dy + "px";
                      //imageDiv().style.left = parseInt(startLeft)+(event.clientX - dragPosX) + "px";
                      //alert(imageDiv().style.left);
                  }
                  event.preventDefault();
              },
              false
            );

            outerDiv().addEventListener("mouseup", // stop moving image
              function (event) {
                  dragging = false;
                  imageDiv().style.cursor = "default";
                  event.preventDefault();
              },
              false
            );
        }
    </script>
</head>
<body>
    <a id="info"></a>
    <div id="_outerDiv">
        <div id="_imageDiv" style="z-index:0; position:relative; top:0px; left:0px; width:200px; height:150px;">
            <img id="_imageObj" src="http://avatar.csdn.net/E/3/5/1_cheungmine.jpg"></img>
        </div>
    </div>
</body>
||||||| .r93
    }, false);
      //outerDiv().addEventListener("mousemove", // moving image  
      //  function (event) {  
      //    if (dragging){  
      //      imageDiv().style.cursor="pointer";  
          
      //    //  imageDiv().style.top = "0px";  
      //      var dx = parseInt(startLeft)+(event.clientX - dragPosX);  
	  //  	var dy =  parseInt(startTop)+(event.clientY - dragPosY);  
      //      if(dx<0){  
      //          dx = 0;  
      //      }else if(dx > 300){  //可拖动框宽度减去图片宽度  
      //          dx = 300;  
      //      }
	  //  	if(dy<0)
	  //  	{
	  //  	dy= 0;
	  //  	}else if(dy>200){
	  //  	dy=200;
	  //  	}
      //      imageDiv().style.left = dx + "px";  
	  //  //	 imageDiv().style.top = parseInt(startTop)+(event.clientY - dragPosY) + "px";  
	  //  	  imageDiv().style.top =dy + "px";  
      //      //imageDiv().style.left = parseInt(startLeft)+(event.clientX - dragPosX) + "px";  
      //      //alert(imageDiv().style.left);  
      //    }  
      //    event.preventDefault();  
      //  },  
      //  false  
      //);  
  
      //outerDiv().addEventListener("mouseup", // stop moving image  
      //  function (event) {  
      //    dragging = false;  
      //    imageDiv().style.cursor="default";            
      //    event.preventDefault();  
      //  },  
      //  false  
      //);  
    }  
  </script>  
</head>  
<body>  
<a id="info"></a>
  <div id="_outerDiv">  
    <div id="_imageDiv" style="z-index:0; position:relative; top:0px; left:0px; width:200px; height:150px;">  
      <img id="_imageObj" src="http://avatar.csdn.net/E/3/5/1_cheungmine.jpg"></img>  
    </div>  
  </div>  
</body>  
=======
    </style>
    <script type="text/javascript">
        function getElem(id) {
            return document.getElementById(id);
        }

        function trimPX(_px) {
            if (_px == null || _px == "")
                return 0;
            return parseInt(_px.substr(0, _px.lastIndexOf("px")));
        }

        function hitInRect(hitX, hitY, rcLeft, rcTop, rcWidth, rcHeight) {
            return (hitX >= rcLeft && hitX < rcLeft + rcWidth && hitY >= rcTop && hitY < rcTop + rcHeight);
        }

        function outerDiv() {
            return getElem("_outerDiv");
        }

        function imageDiv() {
            return getElem("_imageDiv");
        }

        var dragging = false;
        var startTop = 0; // top is a Key Word in Chrome and Opera
        var startLeft = 0;
        var dragPosY = 0;
        var dragPosX = 0;

        window.addEventListener("load", initPage, false);

        function initPage() {
            outerDiv().addEventListener("mousedown", // start moving image
                function (event) {
                    startTop = trimPX(imageDiv().style.top);
                    startLeft = trimPX(imageDiv().style.left);
                    var width = trimPX(imageDiv().style.width);
                    var height = trimPX(imageDiv().style.height);

                    if (hitInRect(event.clientX, event.clientY, startLeft, startTop, width, height)) {
                        dragging = true;
                        dragPosX = event.clientX;
                        dragPosY = event.clientY;
                        event.preventDefault(); // disable default behavior of browser
                    }
                },
                false
            );
            // imageDiv().addEventListener('touchmove', function (event) {
            //     event.preventDefault();//阻止其他事件
            //     // 如果这个元素的位置内只有一个手指的话
            //     $("#info").innterHTML = "被触摸:" + event.targetTouches.length;
            //     if (event.targetTouches.length == 1) {
            //         var touch = event.targetTouches[0];  // 把元素放在手指所在的位置
            //         div.style.left = touch.pageX + 'px';
            //         div.style.top = touch.pageY + 'px';
            //     }
            // }, false);
            outerDiv().addEventListener("mousemove", // moving image
                function (event) {
                    if (dragging) {
                        imageDiv().style.cursor = "pointer";

                        //  imageDiv().style.top = "0px";
                        var dx = parseInt(startLeft) + (event.clientX - dragPosX);
                        var dy = parseInt(startTop) + (event.clientY - dragPosY);
                        if (dx < 0) {
                            dx = 0;
                        } else if (dx > 300) {  //可拖动框宽度减去图片宽度
                            dx = 300;
                        }
                        if (dy < 0) {
                            dy = 0;
                        } else if (dy > 200) {
                            dy = 200;
                        }
                        imageDiv().style.left = dx + "px";
                        //	 imageDiv().style.top = parseInt(startTop)+(event.clientY - dragPosY) + "px";
                        imageDiv().style.top = dy + "px";
                        //imageDiv().style.left = parseInt(startLeft)+(event.clientX - dragPosX) + "px";
                        //alert(imageDiv().style.left);
                    }
                    event.preventDefault();
                },
                false
            );

            outerDiv().addEventListener("mouseup", // stop moving image
                function (event) {
                    dragging = false;
                    imageDiv().style.cursor = "default";
                    event.preventDefault();
                },
                false
            );
        }
    </script>
</head>
<body>
<a id="info"></a>
<div id="_outerDiv">
    <div id="_imageDiv" style="z-index:0; position:relative; top:0px; left:0px; width:200px; height:150px;">
        <img id="_imageObj" src="http://avatar.csdn.net/E/3/5/1_cheungmine.jpg"></img>
    </div>
</div>
</body>
>>>>>>> .r94
</html>  